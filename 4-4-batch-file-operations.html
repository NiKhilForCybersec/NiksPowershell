<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4.4 Batch File Operations - PowerShell & Scripting Guide</title>
    <link rel="stylesheet" href="main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="layout-wrapper">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <div class="sidebar-logo-icon">üñ•Ô∏è</div>
                    <div class="sidebar-logo-text">
                        PowerShell & Scripting
                        <span>Ultimate Guide</span>
                    </div>
                </div>
                <div class="search-container">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" placeholder="Search documentation...">
                    <span class="search-shortcut">Ctrl+K</span>
                </div>
            </div>
            <nav class="sidebar-nav">
                <!-- Section 1: Scripting Fundamentals -->
                <div class="nav-section" data-section="fundamentals">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üìö</span>
                        Scripting Fundamentals
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="1-1-scripting-overview.html" class="nav-link"><span class="nav-link-number">1.1</span> Scripting Overview</a>
                        <a href="1-2-choosing-right-tool.html" class="nav-link"><span class="nav-link-number">1.2</span> Choosing the Right Tool</a>
                        <a href="1-3-setting-up-environment.html" class="nav-link"><span class="nav-link-number">1.3</span> Setting Up Environment</a>
                    </div>
                </div>

                <!-- Section 2: PowerShell Deep Dive -->
                <div class="nav-section" data-section="powershell">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üî∑</span>
                        PowerShell Deep Dive
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="2-1-powershell-intro.html" class="nav-link"><span class="nav-link-number">2.1</span> PowerShell Introduction</a>
                        <a href="2-2-cmdlet-anatomy.html" class="nav-link"><span class="nav-link-number">2.2</span> Cmdlet Anatomy</a>
                        <a href="2-3-pipeline-mastery.html" class="nav-link"><span class="nav-link-number">2.3</span> Pipeline Mastery</a>
                        <a href="2-4-variables-data-types.html" class="nav-link"><span class="nav-link-number">2.4</span> Variables & Data Types</a>
                        <a href="2-5-working-with-objects.html" class="nav-link"><span class="nav-link-number">2.5</span> Working with Objects</a>
                        <a href="2-6-control-structures.html" class="nav-link"><span class="nav-link-number">2.6</span> Control Structures</a>
                        <a href="2-7-functions.html" class="nav-link"><span class="nav-link-number">2.7</span> Functions</a>
                        <a href="2-8-files.html" class="nav-link"><span class="nav-link-number">2.8</span> Working with Files</a>
                        <a href="2-9-wmi-cim.html" class="nav-link"><span class="nav-link-number">2.9</span> WMI & CIM</a>
                        <a href="2-10-registry.html" class="nav-link"><span class="nav-link-number">2.10</span> Registry Operations</a>
                        <a href="2-11-eventlog-analysis.html" class="nav-link"><span class="nav-link-number">2.11</span> Event Log Analysis</a>
                        <a href="2-12-active-directory.html" class="nav-link"><span class="nav-link-number">2.12</span> Active Directory</a>
                        <a href="2-13-networking-commands.html" class="nav-link"><span class="nav-link-number">2.13</span> Networking Commands</a>
                        <a href="2-14-web-requests.html" class="nav-link"><span class="nav-link-number">2.14</span> Web Requests & APIs</a>
                        <a href="2-15-remoting-jobs.html" class="nav-link"><span class="nav-link-number">2.15</span> Remoting & Jobs</a>
                        <a href="2-16-error-handling.html" class="nav-link"><span class="nav-link-number">2.16</span> Error Handling</a>
                        <a href="2-17-modules-profiles.html" class="nav-link"><span class="nav-link-number">2.17</span> Modules & Profiles</a>
                    </div>
                </div>

                <!-- Section 3: Bash Scripting -->
                <div class="nav-section" data-section="bash">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üêß</span>
                        Bash Scripting
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="3-1-bash-intro.html" class="nav-link"><span class="nav-link-number">3.1</span> Bash Introduction</a>
                        <a href="3-2-bash-variables.html" class="nav-link"><span class="nav-link-number">3.2</span> Variables & Data Types</a>
                        <a href="3-3-control-structures.html" class="nav-link"><span class="nav-link-number">3.3</span> Control Structures</a>
                        <a href="3-4-bash-functions.html" class="nav-link"><span class="nav-link-number">3.4</span> Functions & Scripts</a>
                        <a href="3-5-file-io.html" class="nav-link"><span class="nav-link-number">3.5</span> File I/O</a>
                        <a href="3-6-process-management.html" class="nav-link"><span class="nav-link-number">3.6</span> Process Management</a>
                        <a href="3-7-system-admin.html" class="nav-link"><span class="nav-link-number">3.7</span> System Administration</a>
                        <a href="3-8-regex.html" class="nav-link"><span class="nav-link-number">3.8</span> Regular Expressions</a>
                        <a href="3-9-text-processing.html" class="nav-link"><span class="nav-link-number">3.9</span> Text Processing</a>
                        <a href="3-10-bash-networking.html" class="nav-link"><span class="nav-link-number">3.10</span> Bash Networking</a>
                    </div>
                </div>

                <!-- Section 4: Batch/CMD Scripting -->
                <div class="nav-section" data-section="batch">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üì¶</span>
                        Batch/CMD Scripting
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="4-1-batch-intro.html" class="nav-link"><span class="nav-link-number">4.1</span> Batch Introduction</a>
                        <a href="4-2-batch-variables.html" class="nav-link"><span class="nav-link-number">4.2</span> Variables & Parameters</a>
                        <a href="4-3-batch-control-flow.html" class="nav-link"><span class="nav-link-number">4.3</span> Control Flow</a>
                        <a href="4-4-batch-file-operations.html" class="nav-link"><span class="nav-link-number">4.4</span> File Operations</a>
                    </div>
                </div>

                <!-- Section 5: Security Automation -->
                <div class="nav-section" data-section="security">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üõ°Ô∏è</span>
                        Security Automation
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="5-1-incident-response.html" class="nav-link"><span class="nav-link-number">5.1</span> Incident Response</a>
                        <a href="5-2-threat-hunting.html" class="nav-link"><span class="nav-link-number">5.2</span> Threat Hunting</a>
                        <a href="5-3-vulnerability-scanning.html" class="nav-link"><span class="nav-link-number">5.3</span> Vulnerability Scanning</a>
                        <a href="5-4-forensics-scripts.html" class="nav-link"><span class="nav-link-number">5.4</span> Forensics Scripts</a>
                        <a href="5-5-siem-integration.html" class="nav-link"><span class="nav-link-number">5.5</span> SIEM Integration</a>
                        <a href="5-6-edr-automation.html" class="nav-link"><span class="nav-link-number">5.6</span> EDR Automation</a>
                        <a href="5-7-compliance-automation.html" class="nav-link"><span class="nav-link-number">5.7</span> Compliance Automation</a>
                        <a href="5-8-log-analysis.html" class="nav-link"><span class="nav-link-number">5.8</span> Log Analysis</a>
                        <a href="5-9-malware-analysis.html" class="nav-link"><span class="nav-link-number">5.9</span> Malware Analysis</a>
                    </div>
                </div>

                <!-- Section 6: Python Scripting -->
                <div class="nav-section" data-section="python">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üêç</span>
                        Python Scripting
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="6-1-python-security-intro.html" class="nav-link"><span class="nav-link-number">6.1</span> Python for Security</a>
                        <a href="6-2-python-fundamentals.html" class="nav-link"><span class="nav-link-number">6.2</span> Python Fundamentals</a>
                        <a href="6-3-python-functions.html" class="nav-link"><span class="nav-link-number">6.3</span> Functions & Modules</a>
                        <a href="6-4-python-file-handling.html" class="nav-link"><span class="nav-link-number">6.4</span> File & Data Handling</a>
                        <a href="6-5-python-networking.html" class="nav-link"><span class="nav-link-number">6.5</span> Python Networking</a>
                        <a href="6-6-python-security-automation.html" class="nav-link"><span class="nav-link-number">6.6</span> Security Automation</a>
                        <a href="6-7-python-forensics.html" class="nav-link"><span class="nav-link-number">6.7</span> Forensics & Log Analysis</a>
                        <a href="6-8-python-apis.html" class="nav-link"><span class="nav-link-number">6.8</span> Python & APIs</a>
                    </div>
                </div>

                <!-- Section 7: Cloud Automation -->
                <div class="nav-section collapsed" data-section="cloud">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">‚òÅÔ∏è</span>
                        Cloud Automation
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="7-1-azure-automation.html" class="nav-link"><span class="nav-link-number">7.1</span> Azure Automation</a>
                    </div>
                </div>

                <!-- Section 8: Real-World Projects -->
                <div class="nav-section collapsed" data-section="projects">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üöÄ</span>
                        Real-World Projects
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="8-1-security-dashboard.html" class="nav-link"><span class="nav-link-number">8.1</span> Security Dashboard</a>
                        <a href="8-2-log-aggregator.html" class="nav-link"><span class="nav-link-number">8.2</span> Log Aggregator</a>
                        <a href="8-3-asset-inventory.html" class="nav-link"><span class="nav-link-number">8.3</span> Asset Inventory</a>
                    </div>
                </div>

                <!-- Section 9: Troubleshooting -->
                <div class="nav-section collapsed" data-section="troubleshooting">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üîß</span>
                        Troubleshooting
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="9-1-common-errors.html" class="nav-link"><span class="nav-link-number">9.1</span> Common Errors</a>
                        <a href="9-2-debugging-techniques.html" class="nav-link"><span class="nav-link-number">9.2</span> Debugging Techniques</a>
                        <a href="9-3-performance-issues.html" class="nav-link"><span class="nav-link-number">9.3</span> Performance Issues</a>
                    </div>
                </div>

                <!-- Section 10: Reference -->
                <div class="nav-section collapsed" data-section="reference">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üìñ</span>
                        Reference
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="10-1-cheat-sheets.html" class="nav-link"><span class="nav-link-number">10.1</span> Cheat Sheets</a>
                        <a href="10-2-interview-preparation.html" class="nav-link"><span class="nav-link-number">10.2</span> Interview Preparation</a>
                        <a href="10-3-log-paths-reference.html" class="nav-link"><span class="nav-link-number">10.3</span> Log Paths Reference</a>
                    </div>
                </div>
            </nav>
        </aside>

        </aside>

        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="4-1-batch-intro.html">Batch Scripting</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>File Operations</span>
                </nav>

                <h1>4.4 Batch File Operations</h1>

                <div class="info-box overview-box">
                    <div class="info-box-header">
                        <div class="info-box-icon">üìñ</div>
                        <div class="info-box-title">What You'll Learn</div>
                    </div>
                    <ul>
                        <li>Reading and writing files</li>
                        <li>Copying, moving, and deleting files</li>
                        <li>Directory operations</li>
                        <li>File attributes and permissions</li>
                        <li>Redirecting output and piping</li>
                    </ul>
                </div>

                <h2>Reading Files</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Batch - Reading Files</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>@echo off
SETLOCAL EnableDelayedExpansion

REM Display entire file
TYPE config.txt

REM Read file line by line
FOR /F "tokens=*" %%line IN (servers.txt) DO (
    echo Processing: %%line
)

REM Skip comment lines (starting with #)
FOR /F "eol=# tokens=*" %%line IN (config.txt) DO (
    echo Config: %%line
)

REM Read with line numbers
SET linenum=0
FOR /F "tokens=*" %%line IN (data.txt) DO (
    SET /A linenum+=1
    echo !linenum!: %%line
)

REM Read specific columns (CSV-like)
REM ip,hostname,status
FOR /F "tokens=1,2,3 delims=," %%a IN (inventory.csv) DO (
    echo IP: %%a  Host: %%b  Status: %%c
)

REM Find specific content
TYPE log.txt | FIND "ERROR"
TYPE log.txt | FINDSTR /I "error warning critical"</code></pre>
                </div>

                <h2>Writing Files</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Batch - Writing Files</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>@echo off

REM Overwrite file (single >)
echo Log started at %DATE% %TIME% > log.txt

REM Append to file (double >>)
echo First entry >> log.txt
echo Second entry >> log.txt

REM Write multiple lines
(
    echo Line 1
    echo Line 2
    echo Line 3
) > multiline.txt

REM Write without newline (sort of)
<nul set /p ="No newline here" > output.txt

REM Create empty file
type nul > empty.txt
copy nul empty2.txt >nul

REM Redirect command output
dir /b > filelist.txt
ipconfig /all > network_config.txt
systeminfo > sysinfo.txt

REM Redirect errors separately
command.exe > output.txt 2> errors.txt

REM Redirect both stdout and stderr
command.exe > all_output.txt 2>&1

REM Suppress all output
command.exe >nul 2>&1</code></pre>
                </div>

                <div class="info-box memory-box">
                    <div class="info-box-header">
                        <div class="info-box-icon">üß†</div>
                        <div class="info-box-title">Redirection Quick Reference</div>
                    </div>
                    <p><code>&gt;</code> - Overwrite file<br>
                    <code>&gt;&gt;</code> - Append to file<br>
                    <code>2&gt;</code> - Redirect errors (stderr)<br>
                    <code>2&gt;&amp;1</code> - Redirect errors to same as output<br>
                    <code>&gt;nul</code> - Discard output<br>
                    <code>&lt;</code> - Read input from file</p>
                </div>

                <h2>Copying Files</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Batch - Copy Operations</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>@echo off

REM Basic copy
COPY source.txt destination.txt

REM Copy to directory
COPY file.txt C:\Backup\

REM Copy multiple files
COPY *.txt C:\Backup\
COPY file1.txt+file2.txt combined.txt

REM Copy with confirmation suppression
COPY /Y source.txt dest.txt

REM XCOPY for more control
XCOPY source.txt C:\Backup\ /Y

REM Copy directory structure
XCOPY C:\Source C:\Dest /E /I /Y
REM /E = include empty dirs
REM /I = assume destination is directory
REM /Y = no confirmation

REM Copy only newer files
XCOPY C:\Source C:\Backup /D /Y

REM Copy with attributes preserved
XCOPY C:\Source C:\Backup /E /H /K /Y
REM /H = hidden and system files
REM /K = keep attributes

REM ROBOCOPY (more robust, recommended)
ROBOCOPY C:\Source C:\Dest /E /R:3 /W:5
REM /E = subdirectories including empty
REM /R:3 = retry 3 times
REM /W:5 = wait 5 seconds between retries

REM Mirror a directory
ROBOCOPY C:\Source C:\Mirror /MIR</code></pre>
                </div>

                <h2>Moving and Renaming</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Batch - Move and Rename</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>@echo off

REM Move file
MOVE file.txt C:\Archive\

REM Move with overwrite
MOVE /Y file.txt C:\Archive\

REM Rename file
REN oldname.txt newname.txt
RENAME oldname.txt newname.txt

REM Rename multiple files
REN *.txt *.bak

REM Move and rename
MOVE file.txt C:\Archive\newname.txt

REM Move directory
MOVE C:\OldFolder C:\NewLocation\

REM Batch rename with date
FOR %%f IN (*.log) DO (
    SET filename=%%~nf
    REN "%%f" "%%~nf_%DATE:~-4%-%DATE:~-10,2%-%DATE:~-7,2%.log"
)</code></pre>
                </div>

                <h2>Deleting Files</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Batch - Delete Operations</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>@echo off

REM Delete single file
DEL file.txt
ERASE file.txt

REM Delete without confirmation
DEL /Q file.txt

REM Delete with force (read-only)
DEL /F file.txt

REM Delete multiple files
DEL *.tmp
DEL /Q /F C:\Temp\*.log

REM Delete recursively (dangerous!)
DEL /S /Q C:\Temp\*.tmp

REM Delete directory (empty only)
RMDIR C:\EmptyFolder
RD C:\EmptyFolder

REM Delete directory with contents
RMDIR /S /Q C:\FolderToDelete
RD /S /Q C:\Temp\OldLogs

REM Safe delete pattern - check first
IF EXIST "C:\Temp\*.tmp" (
    echo Deleting temp files...
    DEL /Q "C:\Temp\*.tmp"
) ELSE (
    echo No temp files to delete
)</code></pre>
                </div>

                <div class="info-box warning-box">
                    <div class="info-box-header">
                        <div class="info-box-icon">‚ö†Ô∏è</div>
                        <div class="info-box-title">Caution</div>
                    </div>
                    <p><code>DEL /S /Q</code> and <code>RMDIR /S /Q</code> are destructive and don't prompt for confirmation. Always test with <code>echo</code> first or add confirmation prompts in scripts.</p>
                </div>

                <h2>Directory Operations</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Batch - Directory Commands</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>@echo off

REM Create directory
MKDIR C:\NewFolder
MD C:\Another\Nested\Folder

REM Change directory
CD C:\Windows
CD /D D:\Data    REM /D changes drive too
PUSHD C:\Temp    REM Save current, go to new
POPD             REM Return to saved

REM List directory
DIR
DIR /B           REM Bare format (names only)
DIR /S           REM Include subdirectories  
DIR /A           REM Show all including hidden
DIR /A:H         REM Hidden files only
DIR /A:D         REM Directories only
DIR /O:D         REM Order by date
DIR /O:-D        REM Order by date descending

REM Get current directory
echo %CD%

REM Check if directory exists
IF EXIST "C:\Folder\" echo Exists
IF EXIST "C:\Folder\NUL" echo Exists (alt)

REM Tree view
TREE C:\Scripts
TREE /F C:\Scripts    REM Include files</code></pre>
                </div>

                <h2>File Attributes</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Batch - File Attributes</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>@echo off

REM View attributes
ATTRIB file.txt
ATTRIB C:\Windows\*.*

REM Attribute flags:
REM R = Read-only
REM A = Archive
REM S = System
REM H = Hidden
REM I = Not content indexed

REM Set hidden attribute
ATTRIB +H secret.txt

REM Remove hidden attribute
ATTRIB -H secret.txt

REM Set read-only
ATTRIB +R important.txt

REM Set hidden and system (like malware does)
ATTRIB +H +S malicious.exe

REM Remove all attributes
ATTRIB -H -S -R file.txt

REM Find hidden files
DIR /A:H
ATTRIB /S /D | FIND "H"

REM Security check: Find hidden executables
echo Checking for hidden executables...
FOR /R C:\Users %%f IN (*.exe *.bat *.cmd *.vbs *.ps1) DO (
    ATTRIB "%%f" | FIND "H" >nul && echo [HIDDEN] %%f
)</code></pre>
                </div>

                <h2>Piping and Filtering</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Batch - Pipes and Filters</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>@echo off

REM Pipe output to another command
DIR | FIND "txt"
TYPE log.txt | MORE
netstat -an | FIND "ESTABLISHED"

REM FIND command
TYPE file.txt | FIND "search term"
TYPE file.txt | FIND /I "case insensitive"
TYPE file.txt | FIND /C "count"          REM Count matches
TYPE file.txt | FIND /N "with numbers"   REM Line numbers
TYPE file.txt | FIND /V "exclude this"   REM Inverse match

REM FINDSTR (more powerful, regex support)
TYPE file.txt | FINDSTR "pattern"
TYPE file.txt | FINDSTR /I "case insensitive"
TYPE file.txt | FINDSTR /R "regex.*pattern"
TYPE file.txt | FINDSTR /B "starts with"
TYPE file.txt | FINDSTR /E "ends with"

REM Multiple patterns
TYPE log.txt | FINDSTR "error warning critical"

REM Search in files directly
FINDSTR "password" *.txt
FINDSTR /S /I "password" C:\Users\*.txt

REM SORT
TYPE names.txt | SORT
TYPE names.txt | SORT /R    REM Reverse
DIR /B | SORT

REM MORE for paging
TYPE largefile.txt | MORE
DIR /S | MORE</code></pre>
                </div>

                <h2>Security Script: Log Collector</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Batch - Evidence Collector</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>@echo off
SETLOCAL EnableDelayedExpansion

REM Evidence collection script
SET case_id=%1
IF "%case_id%"=="" (
    SET /P case_id=Enter Case ID: 
)

SET evidence_dir=C:\Evidence\%case_id%_%COMPUTERNAME%
SET timestamp=%DATE:~-4%%DATE:~-10,2%%DATE:~-7,2%_%TIME:~0,2%%TIME:~3,2%

echo ==========================================
echo Evidence Collection - Case: %case_id%
echo Target: %COMPUTERNAME%
echo Time: %DATE% %TIME%
echo ==========================================

REM Create evidence directory
MKDIR "%evidence_dir%" 2>nul

REM Collect system info
echo [*] Collecting system information...
systeminfo > "%evidence_dir%\systeminfo.txt"
ipconfig /all > "%evidence_dir%\network.txt"
netstat -anob > "%evidence_dir%\connections.txt"
tasklist /v > "%evidence_dir%\processes.txt"

REM Collect event logs
echo [*] Exporting event logs...
wevtutil epl Security "%evidence_dir%\Security.evtx"
wevtutil epl System "%evidence_dir%\System.evtx"
wevtutil epl Application "%evidence_dir%\Application.evtx"

REM Collect startup items
echo [*] Collecting startup locations...
(
    echo === Registry Run Keys ===
    reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
    reg query "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
    echo.
    echo === Scheduled Tasks ===
    schtasks /query /fo LIST
) > "%evidence_dir%\persistence.txt"

REM Collect recent files
echo [*] Listing recent files...
DIR /S /O:D "C:\Users\%USERNAME%\Recent" > "%evidence_dir%\recent_files.txt" 2>nul

REM Create hash manifest
echo [*] Creating file manifest...
(
    FOR %%f IN ("%evidence_dir%\*.*") DO (
        certutil -hashfile "%%f" SHA256 | FIND /V "hash" | FIND /V "CertUtil"
        echo File: %%~nxf
        echo.
    )
) > "%evidence_dir%\manifest.txt"

echo.
echo ==========================================
echo Collection complete!
echo Evidence saved to: %evidence_dir%
echo ==========================================

ENDLOCAL</code></pre>
                </div>

                <h2>Key Takeaways</h2>
                <ul>
                    <li><code>TYPE</code> displays files, <code>FOR /F</code> reads line by line</li>
                    <li><code>&gt;</code> overwrites, <code>&gt;&gt;</code> appends, <code>2&gt;&amp;1</code> combines streams</li>
                    <li><code>COPY</code> for files, <code>XCOPY</code>/<code>ROBOCOPY</code> for directories</li>
                    <li><code>ATTRIB</code> manages hidden, read-only, and system attributes</li>
                    <li><code>FIND</code> for simple search, <code>FINDSTR</code> for regex patterns</li>
                    <li>Always use <code>/Q</code> carefully - it suppresses confirmations</li>
                </ul>

                                <div class="page-navigation">
                    <a href="4-3-batch-control-flow.html" class="nav-button prev">
                        <span class="nav-button-label">Previous</span>
                        <span class="nav-button-title">‚Üê 4.3 Control Flow</span>
                    </a>
                    <a href="5-1-incident-response.html" class="nav-button next">
                        <span class="nav-button-label">Next</span>
                        <span class="nav-button-title">5.1 Incident Response ‚Üí</span>
                    </a>
                </div>
            </div>
        </main>
    </div>

    <div class="search-modal" id="searchModal">
        <div class="search-modal-content">
            <input type="text" class="search-modal-input" id="searchModalInput" placeholder="Search documentation..." autocomplete="off">
            <div class="search-modal-results" id="searchResults"></div>
        </div>
    </div>

    <button class="mobile-toggle">‚ò∞</button>
    <script src="main.js"></script>
</body>
</html>
