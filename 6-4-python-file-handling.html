<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6.4 Python File & Data Handling - PowerShell & Scripting Guide</title>
    <link rel="stylesheet" href="main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="layout-wrapper">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <div class="sidebar-logo-icon">üñ•Ô∏è</div>
                    <div class="sidebar-logo-text">
                        PowerShell & Scripting
                        <span>Ultimate Guide</span>
                    </div>
                </div>
                <div class="search-container">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" placeholder="Search documentation...">
                    <span class="search-shortcut">Ctrl+K</span>
                </div>
            </div>
            <nav class="sidebar-nav">
                <!-- Section 1: Scripting Fundamentals -->
                <div class="nav-section" data-section="fundamentals">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üìö</span>
                        Scripting Fundamentals
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="1-1-scripting-overview.html" class="nav-link"><span class="nav-link-number">1.1</span> Scripting Overview</a>
                        <a href="1-2-choosing-right-tool.html" class="nav-link"><span class="nav-link-number">1.2</span> Choosing the Right Tool</a>
                        <a href="1-3-setting-up-environment.html" class="nav-link"><span class="nav-link-number">1.3</span> Setting Up Environment</a>
                    </div>
                </div>

                <!-- Section 2: PowerShell Deep Dive -->
                <div class="nav-section" data-section="powershell">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üî∑</span>
                        PowerShell Deep Dive
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="2-1-powershell-intro.html" class="nav-link"><span class="nav-link-number">2.1</span> PowerShell Introduction</a>
                        <a href="2-2-cmdlet-anatomy.html" class="nav-link"><span class="nav-link-number">2.2</span> Cmdlet Anatomy</a>
                        <a href="2-3-pipeline-mastery.html" class="nav-link"><span class="nav-link-number">2.3</span> Pipeline Mastery</a>
                        <a href="2-4-variables-data-types.html" class="nav-link"><span class="nav-link-number">2.4</span> Variables & Data Types</a>
                        <a href="2-5-working-with-objects.html" class="nav-link"><span class="nav-link-number">2.5</span> Working with Objects</a>
                        <a href="2-6-control-structures.html" class="nav-link"><span class="nav-link-number">2.6</span> Control Structures</a>
                        <a href="2-7-functions.html" class="nav-link"><span class="nav-link-number">2.7</span> Functions</a>
                        <a href="2-8-files.html" class="nav-link"><span class="nav-link-number">2.8</span> Working with Files</a>
                        <a href="2-9-wmi-cim.html" class="nav-link"><span class="nav-link-number">2.9</span> WMI & CIM</a>
                        <a href="2-10-registry.html" class="nav-link"><span class="nav-link-number">2.10</span> Registry Operations</a>
                        <a href="2-11-eventlog-analysis.html" class="nav-link"><span class="nav-link-number">2.11</span> Event Log Analysis</a>
                        <a href="2-12-active-directory.html" class="nav-link"><span class="nav-link-number">2.12</span> Active Directory</a>
                        <a href="2-13-networking-commands.html" class="nav-link"><span class="nav-link-number">2.13</span> Networking Commands</a>
                        <a href="2-14-web-requests.html" class="nav-link"><span class="nav-link-number">2.14</span> Web Requests & APIs</a>
                        <a href="2-15-remoting-jobs.html" class="nav-link"><span class="nav-link-number">2.15</span> Remoting & Jobs</a>
                        <a href="2-16-error-handling.html" class="nav-link"><span class="nav-link-number">2.16</span> Error Handling</a>
                        <a href="2-17-modules-profiles.html" class="nav-link"><span class="nav-link-number">2.17</span> Modules & Profiles</a>
                    </div>
                </div>

                <!-- Section 3: Bash Scripting -->
                <div class="nav-section" data-section="bash">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üêß</span>
                        Bash Scripting
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="3-1-bash-intro.html" class="nav-link"><span class="nav-link-number">3.1</span> Bash Introduction</a>
                        <a href="3-2-bash-variables.html" class="nav-link"><span class="nav-link-number">3.2</span> Variables & Data Types</a>
                        <a href="3-3-control-structures.html" class="nav-link"><span class="nav-link-number">3.3</span> Control Structures</a>
                        <a href="3-4-bash-functions.html" class="nav-link"><span class="nav-link-number">3.4</span> Functions & Scripts</a>
                        <a href="3-5-file-io.html" class="nav-link"><span class="nav-link-number">3.5</span> File I/O</a>
                        <a href="3-6-process-management.html" class="nav-link"><span class="nav-link-number">3.6</span> Process Management</a>
                        <a href="3-7-system-admin.html" class="nav-link"><span class="nav-link-number">3.7</span> System Administration</a>
                        <a href="3-8-regex.html" class="nav-link"><span class="nav-link-number">3.8</span> Regular Expressions</a>
                        <a href="3-9-text-processing.html" class="nav-link"><span class="nav-link-number">3.9</span> Text Processing</a>
                        <a href="3-10-bash-networking.html" class="nav-link"><span class="nav-link-number">3.10</span> Bash Networking</a>
                    </div>
                </div>

                <!-- Section 4: Batch/CMD Scripting -->
                <div class="nav-section" data-section="batch">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üì¶</span>
                        Batch/CMD Scripting
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="4-1-batch-intro.html" class="nav-link"><span class="nav-link-number">4.1</span> Batch Introduction</a>
                        <a href="4-2-batch-variables.html" class="nav-link"><span class="nav-link-number">4.2</span> Variables & Parameters</a>
                        <a href="4-3-batch-control-flow.html" class="nav-link"><span class="nav-link-number">4.3</span> Control Flow</a>
                        <a href="4-4-batch-file-operations.html" class="nav-link"><span class="nav-link-number">4.4</span> File Operations</a>
                    </div>
                </div>

                <!-- Section 5: Security Automation -->
                <div class="nav-section" data-section="security">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üõ°Ô∏è</span>
                        Security Automation
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="5-1-incident-response.html" class="nav-link"><span class="nav-link-number">5.1</span> Incident Response</a>
                        <a href="5-2-threat-hunting.html" class="nav-link"><span class="nav-link-number">5.2</span> Threat Hunting</a>
                        <a href="5-3-vulnerability-scanning.html" class="nav-link"><span class="nav-link-number">5.3</span> Vulnerability Scanning</a>
                        <a href="5-4-forensics-scripts.html" class="nav-link"><span class="nav-link-number">5.4</span> Forensics Scripts</a>
                        <a href="5-5-siem-integration.html" class="nav-link"><span class="nav-link-number">5.5</span> SIEM Integration</a>
                        <a href="5-6-edr-automation.html" class="nav-link"><span class="nav-link-number">5.6</span> EDR Automation</a>
                        <a href="5-7-compliance-automation.html" class="nav-link"><span class="nav-link-number">5.7</span> Compliance Automation</a>
                        <a href="5-8-log-analysis.html" class="nav-link"><span class="nav-link-number">5.8</span> Log Analysis</a>
                        <a href="5-9-malware-analysis.html" class="nav-link"><span class="nav-link-number">5.9</span> Malware Analysis</a>
                    </div>
                </div>

                <!-- Section 6: Python Scripting -->
                <div class="nav-section" data-section="python">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üêç</span>
                        Python Scripting
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="6-1-python-security-intro.html" class="nav-link"><span class="nav-link-number">6.1</span> Python for Security</a>
                        <a href="6-2-python-fundamentals.html" class="nav-link"><span class="nav-link-number">6.2</span> Python Fundamentals</a>
                        <a href="6-3-python-functions.html" class="nav-link"><span class="nav-link-number">6.3</span> Functions & Modules</a>
                        <a href="6-4-python-file-handling.html" class="nav-link"><span class="nav-link-number">6.4</span> File & Data Handling</a>
                        <a href="6-5-python-networking.html" class="nav-link"><span class="nav-link-number">6.5</span> Python Networking</a>
                        <a href="6-6-python-security-automation.html" class="nav-link"><span class="nav-link-number">6.6</span> Security Automation</a>
                        <a href="6-7-python-forensics.html" class="nav-link"><span class="nav-link-number">6.7</span> Forensics & Log Analysis</a>
                        <a href="6-8-python-apis.html" class="nav-link"><span class="nav-link-number">6.8</span> Python & APIs</a>
                    </div>
                </div>

                <!-- Section 7: Cloud Automation -->
                <div class="nav-section collapsed" data-section="cloud">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">‚òÅÔ∏è</span>
                        Cloud Automation
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="7-1-azure-automation.html" class="nav-link"><span class="nav-link-number">7.1</span> Azure Automation</a>
                    </div>
                </div>

                <!-- Section 8: Real-World Projects -->
                <div class="nav-section collapsed" data-section="projects">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üöÄ</span>
                        Real-World Projects
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="8-1-security-dashboard.html" class="nav-link"><span class="nav-link-number">8.1</span> Security Dashboard</a>
                        <a href="8-2-log-aggregator.html" class="nav-link"><span class="nav-link-number">8.2</span> Log Aggregator</a>
                        <a href="8-3-asset-inventory.html" class="nav-link"><span class="nav-link-number">8.3</span> Asset Inventory</a>
                    </div>
                </div>

                <!-- Section 9: Troubleshooting -->
                <div class="nav-section collapsed" data-section="troubleshooting">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üîß</span>
                        Troubleshooting
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="9-1-common-errors.html" class="nav-link"><span class="nav-link-number">9.1</span> Common Errors</a>
                        <a href="9-2-debugging-techniques.html" class="nav-link"><span class="nav-link-number">9.2</span> Debugging Techniques</a>
                        <a href="9-3-performance-issues.html" class="nav-link"><span class="nav-link-number">9.3</span> Performance Issues</a>
                    </div>
                </div>

                <!-- Section 10: Reference -->
                <div class="nav-section collapsed" data-section="reference">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üìñ</span>
                        Reference
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="10-1-cheat-sheets.html" class="nav-link"><span class="nav-link-number">10.1</span> Cheat Sheets</a>
                        <a href="10-2-interview-preparation.html" class="nav-link"><span class="nav-link-number">10.2</span> Interview Preparation</a>
                        <a href="10-3-log-paths-reference.html" class="nav-link"><span class="nav-link-number">10.3</span> Log Paths Reference</a>
                    </div>
                </div>
            </nav>
        </aside>





        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="index.html#python">Python Scripting</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>File & Data Handling</span>
                </nav>

                <h1>6.4 Python File & Data Handling</h1>

                <div class="info-box overview-box">
                    <div class="info-box-header">
                        <div class="info-box-icon">üìñ</div>
                        <div class="info-box-title">What You'll Learn</div>
                    </div>
                    <ul>
                        <li>Reading and writing text files</li>
                        <li>Working with JSON, CSV, and XML data</li>
                        <li>Parsing security logs efficiently</li>
                        <li>Using pandas for large datasets</li>
                        <li>YAML configuration files</li>
                    </ul>
                </div>

                <h2>Text File Operations</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Python - Reading Files</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>from pathlib import Path

# Reading entire file
with open("security.log", "r") as f:
    content = f.read()

# Reading lines into list
with open("security.log", "r") as f:
    lines = f.readlines()  # Includes newlines

# Reading lines (stripped) - preferred
with open("security.log", "r") as f:
    lines = [line.strip() for line in f]

# Using Path (modern approach)
log_path = Path("/var/log/auth.log")
content = log_path.read_text()
lines = content.splitlines()

# Reading large files efficiently (line by line)
def process_large_log(filepath):
    """Process log file without loading into memory"""
    error_count = 0
    with open(filepath, "r") as f:
        for line in f:  # Iterates without loading all
            if "ERROR" in line or "FAILED" in line:
                error_count += 1
                yield line.strip()
    print(f"Total errors: {error_count}")</code></pre>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <span>Python - Writing Files</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code># Write text file
with open("report.txt", "w") as f:
    f.write("Security Scan Report\n")
    f.write("=" * 40 + "\n")

# Append to file
with open("alerts.log", "a") as f:
    f.write(f"{datetime.now().isoformat()} - New alert detected\n")

# Write multiple lines
findings = ["Finding 1: Open port 22", "Finding 2: Weak password", "Finding 3: Missing patches"]
with open("findings.txt", "w") as f:
    f.writelines(line + "\n" for line in findings)

# Using Path
report_path = Path("output/report.txt")
report_path.parent.mkdir(parents=True, exist_ok=True)
report_path.write_text("Report content here")</code></pre>
                </div>

                <h2>JSON Data</h2>
                <p>JSON is the most common format for API responses and configuration files in security tools.</p>

                <div class="code-container">
                    <div class="code-header">
                        <span>Python - JSON Operations</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>import json

# Parse JSON string
json_str = '{"ip": "10.0.0.50", "severity": "high", "port": 443}'
data = json.loads(json_str)
print(data["ip"])  # "10.0.0.50"

# Read JSON file
with open("config.json", "r") as f:
    config = json.load(f)

# Write JSON file (formatted)
alert = {
    "timestamp": "2024-01-15T10:30:00Z",
    "source_ip": "10.0.0.50",
    "dest_ip": "192.168.1.100",
    "severity": "high",
    "indicators": ["malware.exe", "c2.evil.com"],
    "metadata": {
        "analyst": "jdoe",
        "status": "investigating"
    }
}

with open("alert.json", "w") as f:
    json.dump(alert, f, indent=2)

# Convert to JSON string
json_output = json.dumps(alert, indent=2, default=str)  # default=str handles datetime

# Handle nested JSON (API responses)
api_response = '''
{
    "status": "success",
    "data": {
        "alerts": [
            {"id": 1, "severity": "high"},
            {"id": 2, "severity": "medium"}
        ]
    }
}
'''
response = json.loads(api_response)
for alert in response["data"]["alerts"]:
    print(f"Alert {alert['id']}: {alert['severity']}")</code></pre>
                </div>

                <h2>CSV Data</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Python - CSV Operations</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>import csv

# Read CSV file
with open("ip_blocklist.csv", "r") as f:
    reader = csv.reader(f)
    header = next(reader)  # Skip header
    for row in reader:
        ip, reason, date = row
        print(f"Blocked: {ip} - {reason}")

# Read CSV as dictionaries (preferred)
with open("ip_blocklist.csv", "r") as f:
    reader = csv.DictReader(f)
    for row in reader:
        print(f"IP: {row['ip']}, Reason: {row['reason']}")

# Write CSV file
scan_results = [
    {"ip": "10.0.0.1", "port": 22, "status": "open"},
    {"ip": "10.0.0.1", "port": 80, "status": "closed"},
    {"ip": "10.0.0.1", "port": 443, "status": "open"}
]

with open("scan_results.csv", "w", newline="") as f:
    fieldnames = ["ip", "port", "status"]
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    writer.writerows(scan_results)

# Quick CSV read to list of dicts
def read_csv_quick(filepath):
    with open(filepath, "r") as f:
        return list(csv.DictReader(f))</code></pre>
                </div>

                <h2>Pandas for Large Datasets</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Python - Pandas for Security Logs</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>import pandas as pd

# Read various formats
df = pd.read_csv("firewall_logs.csv")
df = pd.read_json("alerts.json")
df = pd.read_excel("inventory.xlsx")

# Quick exploration
print(df.head())           # First 5 rows
print(df.info())           # Column types, null counts
print(df.describe())       # Statistics
print(df.columns.tolist()) # Column names

# Filter data
high_severity = df[df["severity"] == "high"]
recent = df[df["timestamp"] > "2024-01-01"]

# Multiple conditions
critical_external = df[(df["severity"] == "critical") & (df["source_type"] == "external")]

# Group and aggregate
by_severity = df.groupby("severity").size()
by_ip = df.groupby("source_ip").agg({
    "event_id": "count",
    "severity": lambda x: (x == "high").sum()
}).rename(columns={"event_id": "total_events", "severity": "high_events"})

# Find top offenders
top_ips = df["source_ip"].value_counts().head(10)

# Time-based analysis
df["timestamp"] = pd.to_datetime(df["timestamp"])
df.set_index("timestamp", inplace=True)
hourly_counts = df.resample("H").size()

# Export results
high_severity.to_csv("high_severity_alerts.csv", index=False)
top_ips.to_json("top_ips.json")

# Memory-efficient reading for large files
df = pd.read_csv("huge_log.csv", 
                 chunksize=100000,  # Process in chunks
                 usecols=["timestamp", "source_ip", "severity"],  # Only needed columns
                 dtype={"severity": "category"})  # Efficient storage</code></pre>
                </div>

                <div class="info-box memory-box">
                    <div class="info-box-header">
                        <div class="info-box-icon">üß†</div>
                        <div class="info-box-title">Memory Aid: Pandas Operations</div>
                    </div>
                    <p><strong>F-G-A-S</strong>: <strong>F</strong>ilter (df[condition]), <strong>G</strong>roup (groupby), <strong>A</strong>ggregate (sum/count/mean), <strong>S</strong>ort (sort_values)</p>
                </div>

                <h2>XML Parsing</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Python - XML for Security Configs</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>import xml.etree.ElementTree as ET
from lxml import etree  # More powerful, install with pip

# Parse XML file
tree = ET.parse("nmap_scan.xml")
root = tree.getroot()

# Parse XML string
xml_str = """
<scan>
    <host ip="192.168.1.1">
        <port number="22" state="open" service="ssh"/>
        <port number="80" state="open" service="http"/>
    </host>
</scan>
"""
root = ET.fromstring(xml_str)

# Navigate elements
for host in root.findall("host"):
    ip = host.get("ip")
    for port in host.findall("port"):
        print(f"{ip}:{port.get('number')} - {port.get('service')}")

# XPath queries (with lxml)
doc = etree.parse("nmap_scan.xml")
open_ports = doc.xpath("//port[@state='open']")
ssh_hosts = doc.xpath("//host[port[@service='ssh']]/@ip")

# Create XML
root = ET.Element("findings")
for finding in [("XSS", "high"), ("SQLI", "critical")]:
    item = ET.SubElement(root, "finding")
    item.set("type", finding[0])
    item.set("severity", finding[1])

tree = ET.ElementTree(root)
tree.write("findings.xml", encoding="utf-8", xml_declaration=True)</code></pre>
                </div>

                <h2>YAML Configuration</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Python - YAML Config Files</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>import yaml

# Sample config.yaml
yaml_content = """
scanner:
  timeout: 30
  threads: 10
  ports:
    - 22
    - 80
    - 443
    - 3389

targets:
  internal:
    - 10.0.0.0/24
    - 192.168.1.0/24
  external:
    - api.example.com

alerts:
  email:
    enabled: true
    recipients:
      - <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="84f7e1e7f1f6edf0fdc4e7ebe9f4e5eafdaae7ebe9">[email&#160;protected]</a>
      - <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="81f2eee2c1e2eeecf1e0eff8afe2eeec">[email&#160;protected]</a>
  slack:
    enabled: true
    webhook: https://hooks.slack.com/xxx
"""

# Parse YAML
config = yaml.safe_load(yaml_content)

# Access values
timeout = config["scanner"]["timeout"]
ports = config["scanner"]["ports"]
email_enabled = config["alerts"]["email"]["enabled"]

# Load from file
with open("config.yaml", "r") as f:
    config = yaml.safe_load(f)

# Write YAML
output_config = {
    "scan_results": {
        "timestamp": "2024-01-15T10:30:00Z",
        "targets_scanned": 254,
        "open_ports_found": 47
    }
}

with open("results.yaml", "w") as f:
    yaml.dump(output_config, f, default_flow_style=False)</code></pre>
                </div>

                <h2>Log Parsing Example</h2>
                <div class="code-container">
                    <div class="code-header">
                        <span>Python - Complete Log Parser</span>
                        <button class="copy-btn" onclick="copyCode(this)">üìã Copy</button>
                    </div>
                    <pre><code>import re
from datetime import datetime
from collections import Counter

def parse_auth_log(filepath):
    """Parse Linux auth.log for failed login attempts"""
    
    # Regex pattern for failed SSH logins
    pattern = r'(\w+\s+\d+\s+\d+:\d+:\d+).*sshd.*Failed password for (?:invalid user )?(\w+) from ([\d.]+)'
    
    failed_logins = []
    
    with open(filepath, "r") as f:
        for line in f:
            match = re.search(pattern, line)
            if match:
                timestamp_str, username, ip = match.groups()
                failed_logins.append({
                    "timestamp": timestamp_str,
                    "username": username,
                    "source_ip": ip
                })
    
    return failed_logins

def analyze_failed_logins(logins):
    """Analyze failed login attempts for patterns"""
    
    # Count by IP
    ip_counts = Counter(login["source_ip"] for login in logins)
    
    # Count by username
    user_counts = Counter(login["username"] for login in logins)
    
    # Identify potential brute force (>10 attempts)
    brute_force_ips = {ip: count for ip, count in ip_counts.items() if count > 10}
    
    return {
        "total_failures": len(logins),
        "unique_ips": len(ip_counts),
        "unique_users": len(user_counts),
        "top_attacking_ips": ip_counts.most_common(10),
        "top_targeted_users": user_counts.most_common(10),
        "potential_brute_force": brute_force_ips
    }

# Usage
logins = parse_auth_log("/var/log/auth.log")
analysis = analyze_failed_logins(logins)
print(json.dumps(analysis, indent=2))</code></pre>
                </div>

                <h2>Key Takeaways</h2>
                <ul>
                    <li>Always use <code>with</code> statement for file operations (auto-closes)</li>
                    <li>JSON: <code>json.load/dump</code> for files, <code>json.loads/dumps</code> for strings</li>
                    <li>CSV: Use <code>DictReader/DictWriter</code> for easier column access</li>
                    <li>Pandas is essential for large dataset analysis</li>
                    <li>YAML is preferred for human-readable configs</li>
                </ul>

                                                                                <div class="page-navigation">
                    <a href="6-3-python-functions.html" class="nav-button prev">
                        <span class="nav-button-label">Previous</span>
                        <span class="nav-button-title">‚Üê 6.3 Functions & Modules</span>
                    </a>
                    <a href="6-5-python-networking.html" class="nav-button next">
                        <span class="nav-button-label">Next</span>
                        <span class="nav-button-title">6.5 Python Networking ‚Üí</span>
                    </a>
                </div>
            </div>
        </main>
    </div>

    <div class="search-modal" id="searchModal">
        <div class="search-modal-content">
            <input type="text" class="search-modal-input" id="searchModalInput" placeholder="Se